<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <style>
        body { margin: 0; background: #000; overflow: hidden; font-family: 'Arial Black', sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; }

        /* Hardware Accelerated Layering */
        #stage { position: relative; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; }

        /* Text Styles */
        .text-layer { position: absolute; text-align: center; width: 100%; will-change: opacity, transform; }

        #brand {
            font-size: 3rem; color: #fff; letter-spacing: 8px; opacity: 0;
            animation: popIn 0.5s ease-out forwards;
        }

        #sargam {
            font-size: 2rem; color: #00d2ff; text-shadow: 0 0 15px #00d2ff; opacity: 0;
        }

        #uxp {
            font-size: 6rem; color: #ff0033; letter-spacing: -5px; opacity: 0; transform: scale(0.5);
            text-shadow: 0 0 40px #ff0000;
        }

        /* Canvas stays in background */
        canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; opacity: 0.8; }

        /* Animations */
        @keyframes popIn { 0% { opacity: 0; transform: scale(0.8); } 100% { opacity: 1; transform: scale(1); } }
        @keyframes fadeOut { to { opacity: 0; transform: scale(1.1); } }
        @keyframes uxpBoom { 0% { opacity: 0; transform: scale(3); } 80% { transform: scale(0.9); } 100% { opacity: 1; transform: scale(1); } }
    </style>
</head>
<body>

<div id="stage">
    <canvas id="waveCanvas"></canvas>
    <div id="brand" class="text-layer">MusicQ</div>
    <div id="sargam" class="text-layer"></div>
    <div id="uxp" class="text-layer">UxP</div>
</div>

<script>
    // --- CONFIGURATION ---
    const SPEEDS = {
        sargamInterval: 250, // Faster text switching (ms)
        waveSpeed: 0.2       // Faster wave flow
    };

    // --- AUDIO ENGINE (Lightweight) ---
    const AudioEngine = {
        ctx: null,
        init: function() {
            window.AudioContext = window.AudioContext || window.webkitAudioContext;
            this.ctx = new window.AudioContext();
        },
        play: function(freq) {
            if (!this.ctx) this.init();
            if (this.ctx.state === 'suspended') this.ctx.resume(); // Try to force resume

            const osc = this.ctx.createOscillator();
            const gain = this.ctx.createGain();
            osc.frequency.value = freq;
            osc.type = 'sine';

            // Click-less envelope
            gain.gain.setValueAtTime(0, this.ctx.currentTime);
            gain.gain.linearRampToValueAtTime(0.1, this.ctx.currentTime + 0.05);
            gain.gain.exponentialRampToValueAtTime(0.001, this.ctx.currentTime + 0.3);

            osc.connect(gain);
            gain.connect(this.ctx.destination);
            osc.start();
            osc.stop(this.ctx.currentTime + 0.3);
        }
    };

    // --- VISUAL ENGINE ---
    const canvas = document.getElementById('waveCanvas');
    const ctx = canvas.getContext('2d', { alpha: false }); // Optimize for no transparency on base
    let width, height, cy;
    let time = 0;

    function resize() {
        width = canvas.width = window.innerWidth;
        height = canvas.height = window.innerHeight;
        cy = height / 2 + 60;
        ctx.strokeStyle = '#00d2ff';
        ctx.lineWidth = 2;
    }
    window.addEventListener('resize', resize);
    resize();

    function drawWave() {
        // Clear with slight trailing effect for motion blur feel, or pure black for speed
        ctx.fillStyle = '#000000';
        ctx.fillRect(0, 0, width, height);

        ctx.beginPath();
        // OPTIMIZATION: Step by 5 pixels instead of 1
        for (let x = 0; x < width; x += 5) {
            // Simplified Quantum Math: 2 overlapping waves
            const y = cy + Math.sin(x * 0.01 + time) * 30 + Math.sin(x * 0.02 - time * 1.5) * 15;
            x === 0 ? ctx.moveTo(x, y) : ctx.lineTo(x, y);
        }
        ctx.stroke();

        time += SPEEDS.waveSpeed;
        requestAnimationFrame(drawWave);
    }

    // --- SEQUENCER ---
    window.onload = () => {
        // 1. Start Wave Background
        drawWave();

        // 2. Start Audio Sequence
        const brand = document.getElementById('brand');
        const sargam = document.getElementById('sargam');
        const uxp = document.getElementById('uxp');
        const notes = ["Sa", "Re", "Ga", "Ma", "Pa", "Dha", "Ni", "Sa"];
        const freqs = [256, 288, 320, 341, 384, 427, 480, 512];

        setTimeout(async () => {
            // Fade out Brand
            brand.style.animation = "fadeOut 0.5s forwards";
            sargam.style.opacity = "1";

            // Loop through Notes
            for (let i = 0; i < notes.length; i++) {
                sargam.innerText = notes[i];
                AudioEngine.play(freqs[i]);
                // Wait for next note
                await new Promise(r => setTimeout(r, SPEEDS.sargamInterval));
            }

            // Final Transition
            sargam.style.opacity = "0";
            uxp.style.animation = "uxpBoom 0.6s cubic-bezier(0.22, 1, 0.36, 1) forwards";

            // Optional: Redirect after animation
            // setTimeout(() => window.location.href = "home.html", 2000);

        }, 1000); // Wait 1s before starting sequence
    };
</script>
</body>
</html>